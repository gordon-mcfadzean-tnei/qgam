<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Interactive visual checks for additive quantile fits — cqcheckI • qgam</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Interactive visual checks for additive quantile fits — cqcheckI" />

<meta property="og:description" content="Given an additive quantile model, fitted using qgam, cqcheck2DI provides some interactive
             2D plots that allow to check what proportion of responses, y, falls below the fitted quantile.
             This is an interactive version of the cqcheck function." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">qgam</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/qgam.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Interactive visual checks for additive quantile fits</h1>
    
    <div class="hidden name"><code>cqcheckI.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Given an additive quantile model, fitted using <code>qgam</code>, <code>cqcheck2DI</code> provides some interactive
             2D plots that allow to check what proportion of responses, <code>y</code>, falls below the fitted quantile.
             This is an interactive version of the <code>cqcheck</code> function.</p>
    
    </div>

    <pre class="usage"><span class='fu'>cqcheckI</span>(<span class='no'>obj</span>, <span class='no'>v</span>, <span class='kw'>X</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>run</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>width</span> <span class='kw'>=</span> <span class='st'>"100%"</span>,
  <span class='kw'>height</span> <span class='kw'>=</span> <span class='st'>"680px"</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>obj</th>
      <td><p>the output of a <code>qgam</code> call.</p></td>
    </tr>
    <tr>
      <th>v</th>
      <td><p>if a 1D plot is required, <code>v</code> should be either a single character or a numeric vector. In the first case
<code>v</code> should be the names of one of the variables in the dataframe <code>X</code>. In the second case, the length
of <code>v</code> should be equal to the number of rows of <code>X</code>. If a 2D plot is required, <code>v</code> should be 
either a vector of two characters or a matrix with two columns.</p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>a dataframe containing the data used to obtain the conditional quantiles. By default it is NULL, in which
case predictions are made using the model matrix in <code>obj$model</code>.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>vector of responses. Its i-th entry corresponds to the i-th row of X.  By default it is NULL, in which
case it is internally set to <code>obj$y</code>.</p></td>
    </tr>
    <tr>
      <th>run</th>
      <td><p>if TRUE (default) the function produces an interactive plot, otherwise it returns the corresponding shiny app.</p></td>
    </tr>
    <tr>
      <th>width</th>
      <td><p>the width of the main plot. Default is "100%".</p></td>
    </tr>
    <tr>
      <th>height</th>
      <td><p>width the width of the main plot. Default is "680px".</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Simply produces an interactive plot.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This is an interactive version of the <code>cqcheck</code>, see <code><a href='cqcheck.html'>?cqcheck</a></code> for details. The main interactive
         feature is that one can select an area by brushing, and then double-click to zoom in. In the 1D case the vertical 
         part of the selected area is not use: we zoom only along the x axis. Double-clicking without brushing zooms out.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'>#######</span>
<span class='co'># Example 1: Bivariate additive model y~1+x+x^2+z+x*z/2+e, e~N(0, 1)</span>
<span class='co'>#######</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>qgam</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>15560</span>)
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>1000</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='no'>n</span>, <span class='fl'>0</span>, <span class='fl'>1</span>); <span class='no'>z</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='no'>n</span>)
<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/cbind'>cbind</a></span>(<span class='fl'>1</span>, <span class='no'>x</span>, <span class='no'>x</span>^<span class='fl'>2</span>, <span class='no'>z</span>, <span class='no'>x</span>*<span class='no'>z</span>)
<span class='no'>beta</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>0.5</span>)
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/drop'>drop</a></span>(<span class='no'>X</span> <span class='kw'>%*%</span> <span class='no'>beta</span>) + <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='no'>n</span>)
<span class='no'>dataf</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/data.frame'>data.frame</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/cbind'>cbind</a></span>(<span class='no'>y</span>, <span class='no'>x</span>, <span class='no'>z</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/names'>names</a></span>(<span class='no'>dataf</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"y"</span>, <span class='st'>"x"</span>, <span class='st'>"z"</span>)

<span class='co'>#### Fit a constant model for median</span>
<span class='no'>qu</span> <span class='kw'>&lt;-</span> <span class='fl'>0.5</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='qgam.html'>qgam</a></span>(<span class='no'>y</span>~<span class='fl'>1</span>, <span class='kw'>qu</span> <span class='kw'>=</span> <span class='no'>qu</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dataf</span>)

<span class='co'># Look at what happens along x: clearly there is non linear pattern here</span>
<span class='fu'>cqcheckI</span>(<span class='kw'>obj</span> <span class='kw'>=</span> <span class='no'>fit</span>, <span class='kw'>v</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"x"</span>), <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dataf</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>y</span>)

<span class='co'>#### Add a smooth for x</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='qgam.html'>qgam</a></span>(<span class='no'>y</span>~<span class='fu'>s</span>(<span class='no'>x</span>), <span class='kw'>qu</span> <span class='kw'>=</span> <span class='no'>qu</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dataf</span>)
<span class='fu'>cqcheckI</span>(<span class='kw'>obj</span> <span class='kw'>=</span> <span class='no'>fit</span>, <span class='kw'>v</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"x"</span>), <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dataf</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>y</span>) <span class='co'># Better!</span>

<span class='co'># Lets look across across x and z. As we move along z (x2 in the plot) </span>
<span class='co'># the colour changes from green to red</span>
<span class='fu'>cqcheckI</span>(<span class='kw'>obj</span> <span class='kw'>=</span> <span class='no'>fit</span>, <span class='kw'>v</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"x"</span>, <span class='st'>"z"</span>), <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dataf</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>y</span>)

<span class='co'># The effect look pretty linear</span>
<span class='fu'>cqcheckI</span>(<span class='kw'>obj</span> <span class='kw'>=</span> <span class='no'>fit</span>, <span class='kw'>v</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"z"</span>), <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>dataf</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>y</span>)

<span class='co'>#### Lets add a linear effect for z </span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='qgam.html'>qgam</a></span>(<span class='no'>y</span>~<span class='fu'>s</span>(<span class='no'>x</span>)+<span class='no'>z</span>, <span class='kw'>qu</span> <span class='kw'>=</span> <span class='no'>qu</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dataf</span>)

<span class='co'># Looks better!</span>
<span class='fu'>cqcheckI</span>(<span class='kw'>obj</span> <span class='kw'>=</span> <span class='no'>fit</span>, <span class='kw'>v</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"z"</span>))

<span class='co'># Lets look across x and y again: green prevails on the top-left to bottom-right</span>
<span class='co'># diagonal, while the other diagonal is mainly red.</span>
<span class='fu'>cqcheckI</span>(<span class='kw'>obj</span> <span class='kw'>=</span> <span class='no'>fit</span>, <span class='kw'>v</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"x"</span>, <span class='st'>"z"</span>))

<span class='co'>### Maybe adding an interaction would help?</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='qgam.html'>qgam</a></span>(<span class='no'>y</span>~<span class='fu'>s</span>(<span class='no'>x</span>)+<span class='no'>z</span>+<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/AsIs'>I</a></span>(<span class='no'>x</span>*<span class='no'>z</span>), <span class='kw'>qu</span> <span class='kw'>=</span> <span class='no'>qu</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dataf</span>)

<span class='co'># It does! The real model is: y ~ 1 + x + x^2 + z + x*z/2 + e, e ~ N(0, 1)</span>
<span class='fu'>cqcheckI</span>(<span class='kw'>obj</span> <span class='kw'>=</span> <span class='no'>fit</span>, <span class='kw'>v</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"x"</span>, <span class='st'>"z"</span>))
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Matteo Fasiolo &lt;matteo.fasiolo@gmail.com&gt;.</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Matteo Fasiolo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

