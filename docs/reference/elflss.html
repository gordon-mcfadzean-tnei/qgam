<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Extended log-F model with variable scale — elflss • qgam</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Extended log-F model with variable scale — elflss" />

<meta property="og:description" content="The elflss family implements the Extended log-F (ELF) density of Fasiolo et al. (2017) and it is supposed
             to work in conjuction with the general GAM fitting methods of Wood et al. (2017), implemented by
             mgcv. It differs from the elf family, because here the scale of the density 
             (sigma, aka the learning rate) can depend of the covariates, while in 
             while in elf it is a single scalar. NB this function was use within the qgam function, but
             since qgam version 1.3 quantile models with varying learning rate are fitted using different methods
             (a parametric location-scale model, see Fasiolo et al. (2017) for details.)." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">qgam</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/qgam.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extended log-F model with variable scale</h1>
    
    <div class="hidden name"><code>elflss.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>The <code>elflss</code> family implements the Extended log-F (ELF) density of Fasiolo et al. (2017) and it is supposed
             to work in conjuction with the general GAM fitting methods of Wood et al. (2017), implemented by
             <code>mgcv</code>. It differs from the <code>elf</code> family, because here the scale of the density 
             (sigma, aka the learning rate) can depend of the covariates, while in 
             while in <code>elf</code> it is a single scalar. NB this function was use within the <code>qgam</code> function, but
             since <code>qgam</code> version 1.3 quantile models with varying learning rate are fitted using different methods
             (a parametric location-scale model, see Fasiolo et al. (2017) for details.).</p>
    
    </div>

    <pre class="usage"><span class='fu'>elflss</span>(<span class='kw'>link</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='st'>"identity"</span>, <span class='st'>"log"</span>), <span class='no'>qu</span>, <span class='no'>co</span>, <span class='no'>theta</span>, <span class='kw'>remInter</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>link</th>
      <td><p>vector of two characters indicating the link function for the quantile location and for the log-scale.</p></td>
    </tr>
    <tr>
      <th>qu</th>
      <td><p>parameter in (0, 1) representing the chosen quantile. For instance, to fit the median choose <code>qu=0.5</code>.</p></td>
    </tr>
    <tr>
      <th>co</th>
      <td><p>positive vector of constants used to determine parameter lambda of the ELF density (lambda = co / sigma).</p></td>
    </tr>
    <tr>
      <th>theta</th>
      <td><p>a scalar representing the intercept of the model for the log-scale log(sigma).</p></td>
    </tr>
    <tr>
      <th>remInter</th>
      <td><p>if TRUE the intercept of the log-scale model is removed.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object inheriting from mgcv's class <code>general.family</code>.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function is meant for internal use only.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Fasiolo, M., Goude, Y., Nedellec, R. and Wood, S. N. (2017). Fast calibrated additive quantile regression. 
            Available at <a href='https://arxiv.org/abs/1707.03307'>https://arxiv.org/abs/1707.03307</a>.</p>            
<p>Wood, Simon N., Pya, N. and Safken, B. (2017). Smoothing parameter and model selection for 
            general smooth models. Journal of the American Statistical Association.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>651</span>)
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>1000</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq</a></span>(-<span class='fl'>4</span>, <span class='fl'>3</span>, <span class='kw'>length.out</span> <span class='kw'>=</span> <span class='no'>n</span>)
<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/cbind'>cbind</a></span>(<span class='fl'>1</span>, <span class='no'>x</span>, <span class='no'>x</span>^<span class='fl'>2</span>)
<span class='no'>beta</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>1</span>)
<span class='no'>sigma</span> <span class='kw'>=</span>  <span class='fl'>1.2</span> + <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Trig'>sin</a></span>(<span class='fl'>2</span>*<span class='no'>x</span>)
<span class='no'>f</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/drop'>drop</a></span>(<span class='no'>X</span> <span class='kw'>%*%</span> <span class='no'>beta</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='no'>f</span> + <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='no'>n</span>, <span class='fl'>0</span>, <span class='no'>sigma</span>)
<span class='no'>dataf</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/data.frame'>data.frame</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/cbind'>cbind</a></span>(<span class='no'>dat</span>, <span class='no'>x</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/names'>names</a></span>(<span class='no'>dataf</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"y"</span>, <span class='st'>"x"</span>)

<span class='co'># Fit median using elflss directly: NOT RECOMMENDED</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>gam</span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='no'>y</span>~<span class='fu'>s</span>(<span class='no'>x</span>, <span class='kw'>bs</span> <span class='kw'>=</span> <span class='st'>"cr"</span>), ~ <span class='fu'>s</span>(<span class='no'>x</span>, <span class='kw'>bs</span> <span class='kw'>=</span> <span class='st'>"cr"</span>)),
           <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'>elflss</span>(<span class='kw'>theta</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>co</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>0.2</span>, <span class='no'>n</span>), <span class='kw'>qu</span> <span class='kw'>=</span> <span class='fl'>0.5</span>),
           <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dataf</span>)

<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>x</span>, <span class='no'>dat</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"grey"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"y"</span>)
<span class='no'>tmp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/predict'>predict</a></span>(<span class='no'>fit</span>, <span class='kw'>se</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/lines'>lines</a></span>(<span class='no'>x</span>, <span class='no'>tmp</span>$<span class='no'>fit</span>[ , <span class='fl'>1</span>])
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/lines'>lines</a></span>(<span class='no'>x</span>, <span class='no'>tmp</span>$<span class='no'>fit</span>[ , <span class='fl'>1</span>] + <span class='fl'>3</span> * <span class='no'>tmp</span>$<span class='no'>se.fit</span>[ , <span class='fl'>1</span>], <span class='kw'>col</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/lines'>lines</a></span>(<span class='no'>x</span>, <span class='no'>tmp</span>$<span class='no'>fit</span>[ , <span class='fl'>1</span>] - <span class='fl'>3</span> * <span class='no'>tmp</span>$<span class='no'>se.fit</span>[ , <span class='fl'>1</span>], <span class='kw'>col</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='co'># }</span><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Matteo Fasiolo &lt;matteo.fasiolo@gmail.com&gt; and Simon N. Wood.</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Matteo Fasiolo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

